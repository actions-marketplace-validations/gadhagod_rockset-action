name: Add Rockset docs
description: Upload documents to your Rockset collections on repository pushes.
icon: arrow-up-circle
color: purple
on: push
jobs:
  main:
    runs-on: ubuntu-latest
    steps:
      - name: Install dependencies
        run: |
          sudo npm install -g @rockset/cli
      - name: Authorize access
        run: |
          rockset auth:add user ${{ secrets.ROCKSET_TOKEN }}
      - name: Add docs
        run: |
          curl ${{ secrets.DOCS_RAW_URL }} > data.json
          echo "{\"data\": $(cat data.json)" > data.json
          printf "}" >> data.json
          rockset api:documents:addDocuments ${{ secrets.WORKSPACE }} ${{ secrets.COLLECTION }} --body data.json
          rm data.json
